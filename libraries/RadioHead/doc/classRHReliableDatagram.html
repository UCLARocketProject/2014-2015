<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>RadioHead: RHReliableDatagram Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RadioHead
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classRHReliableDatagram-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">RHReliableDatagram Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classRHDatagram.html" title="Manager class for addressed, unreliable messages. ">RHDatagram</a> subclass for sending addressed, acknowledged, retransmitted datagrams.  
 <a href="classRHReliableDatagram.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="RHReliableDatagram_8h_source.html">RHReliableDatagram.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for RHReliableDatagram:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classRHReliableDatagram.png" usemap="#RHReliableDatagram_map" alt=""/>
  <map id="RHReliableDatagram_map" name="RHReliableDatagram_map">
<area href="classRHDatagram.html" title="Manager class for addressed, unreliable messages. " alt="RHDatagram" shape="rect" coords="0,0,128,24"/>
<area href="classRHRouter.html" title="RHReliableDatagram subclass for sending addressed, optionally acknowledged datagrams multi-hop routed..." alt="RHRouter" shape="rect" coords="0,112,128,136"/>
<area href="classRHMesh.html" title="RHRouter subclass for sending addressed, optionally acknowledged datagrams multi-hop routed across a ..." alt="RHMesh" shape="rect" coords="0,168,128,192"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5b0df6c96476358f7a6acb8a5575fe8e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHReliableDatagram.html#a5b0df6c96476358f7a6acb8a5575fe8e">RHReliableDatagram</a> (<a class="el" href="classRHGenericDriver.html">RHGenericDriver</a> &amp;driver, uint8_t <a class="el" href="classRHDatagram.html#a4749623dde8ada6dc6e18b32e3e8ed8f">thisAddress</a>=0)</td></tr>
<tr class="separator:a5b0df6c96476358f7a6acb8a5575fe8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2ba123a53c34f0eb93bef0fe3f1cab0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHReliableDatagram.html#aa2ba123a53c34f0eb93bef0fe3f1cab0">setTimeout</a> (uint16_t timeout)</td></tr>
<tr class="separator:aa2ba123a53c34f0eb93bef0fe3f1cab0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a527306673a822c91d19e91327f2d4a80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHReliableDatagram.html#a527306673a822c91d19e91327f2d4a80">setRetries</a> (uint8_t <a class="el" href="classRHReliableDatagram.html#ac6be14d9e660e1a4538376d4b4931d1d">retries</a>)</td></tr>
<tr class="separator:a527306673a822c91d19e91327f2d4a80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6be14d9e660e1a4538376d4b4931d1d"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHReliableDatagram.html#ac6be14d9e660e1a4538376d4b4931d1d">retries</a> ()</td></tr>
<tr class="separator:ac6be14d9e660e1a4538376d4b4931d1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad282ac147986a63692582f323b56c47f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHReliableDatagram.html#ad282ac147986a63692582f323b56c47f">sendtoWait</a> (uint8_t *buf, uint8_t len, uint8_t address)</td></tr>
<tr class="separator:ad282ac147986a63692582f323b56c47f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af172410589842760babf938a0538334c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHReliableDatagram.html#af172410589842760babf938a0538334c">recvfromAck</a> (uint8_t *buf, uint8_t *len, uint8_t *from=NULL, uint8_t *to=NULL, uint8_t *id=NULL, uint8_t *flags=NULL)</td></tr>
<tr class="separator:af172410589842760babf938a0538334c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac72c7495936b6f655a5765faac609342"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHReliableDatagram.html#ac72c7495936b6f655a5765faac609342">recvfromAckTimeout</a> (uint8_t *buf, uint8_t *len, uint16_t timeout, uint8_t *from=NULL, uint8_t *to=NULL, uint8_t *id=NULL, uint8_t *flags=NULL)</td></tr>
<tr class="separator:ac72c7495936b6f655a5765faac609342"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ed110f1a6a8cbc8de3cd17a1a4cce5c"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHReliableDatagram.html#a4ed110f1a6a8cbc8de3cd17a1a4cce5c">retransmissions</a> ()</td></tr>
<tr class="separator:a4ed110f1a6a8cbc8de3cd17a1a4cce5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01ac6fe8be733e1ccc0791d5ef44bb13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHReliableDatagram.html#a01ac6fe8be733e1ccc0791d5ef44bb13">resetRetransmissions</a> ()</td></tr>
<tr class="separator:a01ac6fe8be733e1ccc0791d5ef44bb13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classRHDatagram"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classRHDatagram')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classRHDatagram.html">RHDatagram</a></td></tr>
<tr class="memitem:ada6271bf28191c2368766785c6ba8b7a inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#ada6271bf28191c2368766785c6ba8b7a">RHDatagram</a> (<a class="el" href="classRHGenericDriver.html">RHGenericDriver</a> &amp;driver, uint8_t <a class="el" href="classRHDatagram.html#a4749623dde8ada6dc6e18b32e3e8ed8f">thisAddress</a>=0)</td></tr>
<tr class="separator:ada6271bf28191c2368766785c6ba8b7a inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe51be17fd7cc8db571c3b3ba2de0816 inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#abe51be17fd7cc8db571c3b3ba2de0816">init</a> ()</td></tr>
<tr class="separator:abe51be17fd7cc8db571c3b3ba2de0816 inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2031c32443b797b275245344c8a36ef1 inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a2031c32443b797b275245344c8a36ef1">setThisAddress</a> (uint8_t <a class="el" href="classRHDatagram.html#a4749623dde8ada6dc6e18b32e3e8ed8f">thisAddress</a>)</td></tr>
<tr class="separator:a2031c32443b797b275245344c8a36ef1 inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99894e3465aa607022cc240cc0394462 inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a99894e3465aa607022cc240cc0394462">sendto</a> (uint8_t *buf, uint8_t len, uint8_t address)</td></tr>
<tr class="separator:a99894e3465aa607022cc240cc0394462 inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76f519f91e9fd435e1c0be67ad999420 inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a76f519f91e9fd435e1c0be67ad999420">recvfrom</a> (uint8_t *buf, uint8_t *len, uint8_t *from=NULL, uint8_t *to=NULL, uint8_t *id=NULL, uint8_t *flags=NULL)</td></tr>
<tr class="separator:a76f519f91e9fd435e1c0be67ad999420 inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a118f5c8f0ac925335cea6f23d2063467 inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a118f5c8f0ac925335cea6f23d2063467">available</a> ()</td></tr>
<tr class="separator:a118f5c8f0ac925335cea6f23d2063467 inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99a90a3d35f6c579dab2a044417077a4 inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a99a90a3d35f6c579dab2a044417077a4">waitAvailable</a> ()</td></tr>
<tr class="separator:a99a90a3d35f6c579dab2a044417077a4 inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b453d9b83c4da71acc62eea77af3d73 inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a3b453d9b83c4da71acc62eea77af3d73">waitPacketSent</a> ()</td></tr>
<tr class="separator:a3b453d9b83c4da71acc62eea77af3d73 inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4a7d3b768b22518228d609dcce8dd0c inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#ae4a7d3b768b22518228d609dcce8dd0c">waitPacketSent</a> (uint16_t timeout)</td></tr>
<tr class="separator:ae4a7d3b768b22518228d609dcce8dd0c inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01757f63f461642e91065421702872a5 inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a01757f63f461642e91065421702872a5">waitAvailableTimeout</a> (uint16_t timeout)</td></tr>
<tr class="separator:a01757f63f461642e91065421702872a5 inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4d577cb119ed5a37d20d9cdbc30c942 inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#aa4d577cb119ed5a37d20d9cdbc30c942">setHeaderTo</a> (uint8_t to)</td></tr>
<tr class="separator:aa4d577cb119ed5a37d20d9cdbc30c942 inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02ceb5bb2662041ed26319d315845f37 inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a02ceb5bb2662041ed26319d315845f37">setHeaderFrom</a> (uint8_t from)</td></tr>
<tr class="separator:a02ceb5bb2662041ed26319d315845f37 inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aac12bf5bcc900eb525fa1676113803 inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a4aac12bf5bcc900eb525fa1676113803">setHeaderId</a> (uint8_t id)</td></tr>
<tr class="separator:a4aac12bf5bcc900eb525fa1676113803 inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10dca3a92476b8ab7728bf39632a44cd inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a10dca3a92476b8ab7728bf39632a44cd">setHeaderFlags</a> (uint8_t set, uint8_t clear=RH_FLAGS_NONE)</td></tr>
<tr class="separator:a10dca3a92476b8ab7728bf39632a44cd inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac24d1bedb469a506a51526341c3f0a58 inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#ac24d1bedb469a506a51526341c3f0a58">headerTo</a> ()</td></tr>
<tr class="separator:ac24d1bedb469a506a51526341c3f0a58 inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a216f6cafb7de91cc85af38dc6155c113 inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a216f6cafb7de91cc85af38dc6155c113">headerFrom</a> ()</td></tr>
<tr class="separator:a216f6cafb7de91cc85af38dc6155c113 inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1db8fccebe40bb24950b1d3a3013880d inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a1db8fccebe40bb24950b1d3a3013880d">headerId</a> ()</td></tr>
<tr class="separator:a1db8fccebe40bb24950b1d3a3013880d inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bb61fc918e1844ec24cb696ec8cd87b inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a7bb61fc918e1844ec24cb696ec8cd87b">headerFlags</a> ()</td></tr>
<tr class="separator:a7bb61fc918e1844ec24cb696ec8cd87b inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4749623dde8ada6dc6e18b32e3e8ed8f inherit pub_methods_classRHDatagram"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a4749623dde8ada6dc6e18b32e3e8ed8f">thisAddress</a> ()</td></tr>
<tr class="separator:a4749623dde8ada6dc6e18b32e3e8ed8f inherit pub_methods_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ad1ea9f35e98d248bf595563e52f66183"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHReliableDatagram.html#ad1ea9f35e98d248bf595563e52f66183">acknowledge</a> (uint8_t id, uint8_t from)</td></tr>
<tr class="separator:ad1ea9f35e98d248bf595563e52f66183"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac66d102a7a344885b9d7f249f10ddd07"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHReliableDatagram.html#ac66d102a7a344885b9d7f249f10ddd07">haveNewMessage</a> ()</td></tr>
<tr class="separator:ac66d102a7a344885b9d7f249f10ddd07"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classRHDatagram"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classRHDatagram')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classRHDatagram.html">RHDatagram</a></td></tr>
<tr class="memitem:a44cd19d6c10e3586f868556e3d6aa67e inherit pro_attribs_classRHDatagram"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a44cd19d6c10e3586f868556e3d6aa67e"></a>
<a class="el" href="classRHGenericDriver.html">RHGenericDriver</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#a44cd19d6c10e3586f868556e3d6aa67e">_driver</a></td></tr>
<tr class="memdesc:a44cd19d6c10e3586f868556e3d6aa67e inherit pro_attribs_classRHDatagram"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Driver we are to use. <br /></td></tr>
<tr class="separator:a44cd19d6c10e3586f868556e3d6aa67e inherit pro_attribs_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae61ea3f68f3365d03249fd5807e989bd inherit pro_attribs_classRHDatagram"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae61ea3f68f3365d03249fd5807e989bd"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRHDatagram.html#ae61ea3f68f3365d03249fd5807e989bd">_thisAddress</a></td></tr>
<tr class="memdesc:ae61ea3f68f3365d03249fd5807e989bd inherit pro_attribs_classRHDatagram"><td class="mdescLeft">&#160;</td><td class="mdescRight">The address of this node. <br /></td></tr>
<tr class="separator:ae61ea3f68f3365d03249fd5807e989bd inherit pro_attribs_classRHDatagram"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classRHDatagram.html" title="Manager class for addressed, unreliable messages. ">RHDatagram</a> subclass for sending addressed, acknowledged, retransmitted datagrams. </p>
<p>Manager class that extends <a class="el" href="classRHDatagram.html" title="Manager class for addressed, unreliable messages. ">RHDatagram</a> to define addressed, reliable datagrams with acknowledgement and retransmission. Based on <a class="el" href="classRHDatagram.html" title="Manager class for addressed, unreliable messages. ">RHDatagram</a>, adds flags and sequence numbers. <a class="el" href="classRHReliableDatagram.html" title="RHDatagram subclass for sending addressed, acknowledged, retransmitted datagrams. ...">RHReliableDatagram</a> is reliable in the sense that messages are acknowledged by the recipient, and unacknowledged messages are retransmitted until acknowledged or the retries are exhausted. When addressed messages are sent (by <a class="el" href="classRHReliableDatagram.html#ad282ac147986a63692582f323b56c47f">sendtoWait()</a>), it will wait for an ack, and retransmit after timeout until an ack is received or retries are exhausted. When addressed messages are collected by the application (by <a class="el" href="classRHReliableDatagram.html#af172410589842760babf938a0538334c">recvfromAck()</a>), an acknowledgement is automatically sent to the sender.</p>
<p>You can use <a class="el" href="classRHReliableDatagram.html" title="RHDatagram subclass for sending addressed, acknowledged, retransmitted datagrams. ...">RHReliableDatagram</a> to send broadcast messages, with a TO address of RH_BROADCAST_ADDRESS, however broadcasts are not acknowledged or retransmitted and are therefore NOT actually reliable.</p>
<p>The retransmit timeout is randomly varied between timeout and timeout*2 to prevent collisions on all retries when 2 nodes happen to start sending at the same time .</p>
<p>Each new message sent by <a class="el" href="classRHReliableDatagram.html#ad282ac147986a63692582f323b56c47f">sendtoWait()</a> has its ID incremented.</p>
<p>An ack consists of a message with:</p><ul>
<li>TO set to the from address of the original message</li>
<li>FROM set to this node address</li>
<li>ID set to the ID of the original message</li>
<li>FLAGS with the RH_FLAGS_ACK bit set</li>
<li>1 octet of payload containing ASCII '!' (since some drivers cannot handle 0 length payloads)</li>
</ul>
<dl class="section user"><dt>Media Access Strategy</dt><dd></dd></dl>
<p><a class="el" href="classRHReliableDatagram.html" title="RHDatagram subclass for sending addressed, acknowledged, retransmitted datagrams. ...">RHReliableDatagram</a> and the underlying drivers always transmit as soon as <a class="el" href="classRHReliableDatagram.html#ad282ac147986a63692582f323b56c47f">sendtoWait()</a> is called. <a class="el" href="classRHReliableDatagram.html" title="RHDatagram subclass for sending addressed, acknowledged, retransmitted datagrams. ...">RHReliableDatagram</a> waits for an acknowledgement, and if one is not received after a timeout period the message is transmitted again. If no acknowledgement is received after several retries, the transmissions is deemed to have failed. No contention for media is detected. This will be recognised as "pure ALOHA". The addition of Clear Channel Assessment (CCA) is desirable and planned.</p>
<p>There is no message queuing or threading in <a class="el" href="classRHReliableDatagram.html" title="RHDatagram subclass for sending addressed, acknowledged, retransmitted datagrams. ...">RHReliableDatagram</a>. <a class="el" href="classRHReliableDatagram.html#ad282ac147986a63692582f323b56c47f">sendtoWait()</a> waits until an acknowledgement is received, retransmitting up to (by default) 3 retries time with a default 200ms timeout. During this transmit-acknowledge phase, any received message (other than the expected acknowledgement) will be ignored. Your sketch will be unresponsive to new messages until an acknowledgement is received or the retries are exhausted. Central server-type sketches should be very cautious about their retransmit strategy and configuration lest they hang for a long time trying to reply to clients that are unreachable. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a5b0df6c96476358f7a6acb8a5575fe8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RHReliableDatagram::RHReliableDatagram </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRHGenericDriver.html">RHGenericDriver</a> &amp;&#160;</td>
          <td class="paramname"><em>driver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>thisAddress</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">driver</td><td>The RadioHead driver to use to transport messages. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thisAddress</td><td>The address to assign to this node. Defaults to 0 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ad1ea9f35e98d248bf595563e52f66183"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RHReliableDatagram::acknowledge </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>from</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Send an ACK for the message id to the given from address Blocks until the ACK has been sent </p>

<p>References <a class="el" href="classRHDatagram.html#a99894e3465aa607022cc240cc0394462">RHDatagram::sendto()</a>, <a class="el" href="classRHDatagram.html#a10dca3a92476b8ab7728bf39632a44cd">RHDatagram::setHeaderFlags()</a>, <a class="el" href="classRHDatagram.html#a4aac12bf5bcc900eb525fa1676113803">RHDatagram::setHeaderId()</a>, and <a class="el" href="classRHDatagram.html#a3b453d9b83c4da71acc62eea77af3d73">RHDatagram::waitPacketSent()</a>.</p>

<p>Referenced by <a class="el" href="classRHReliableDatagram.html#af172410589842760babf938a0538334c">recvfromAck()</a>, and <a class="el" href="classRHReliableDatagram.html#ad282ac147986a63692582f323b56c47f">sendtoWait()</a>.</p>

</div>
</div>
<a class="anchor" id="ac66d102a7a344885b9d7f249f10ddd07"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool RHReliableDatagram::haveNewMessage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Checks whether the message currently in the Rx buffer is a new message, not previously received based on the from address and the sequence. If it is new, it is acknowledged and returns true </p><dl class="section return"><dt>Returns</dt><dd>true if there is a message received and it is a new message </dd></dl>

</div>
</div>
<a class="anchor" id="af172410589842760babf938a0538334c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool RHReliableDatagram::recvfromAck </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>from</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>to</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>id</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>flags</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If there is a valid message available for this node, send an acknowledgement to the SRC address (blocking until this is complete), then copy the message to buf and return true else return false. If a message is copied, *len is set to the length.. If from is not NULL, the SRC address is placed in *from. If to is not NULL, the DEST address is placed in *to. This is the preferred function for getting messages addressed to this node. If the message is not a broadcast, acknowledge to the sender before returning. You should be sure to call this function frequently enough to not miss any messages It is recommended that you call it in your main loop. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Location to copy the received message </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">len</td><td>Available space in buf. Set to the actual number of octets copied. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">from</td><td>If present and not NULL, the referenced uint8_t will be set to the SRC address </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">to</td><td>If present and not NULL, the referenced uint8_t will be set to the DEST address </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>If present and not NULL, the referenced uint8_t will be set to the ID </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>If present and not NULL, the referenced uint8_t will be set to the FLAGS (not just those addressed to this node). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if a valid message was copied to buf </dd></dl>

<p>References <a class="el" href="classRHReliableDatagram.html#ad1ea9f35e98d248bf595563e52f66183">acknowledge()</a>, <a class="el" href="classRHDatagram.html#a118f5c8f0ac925335cea6f23d2063467">RHDatagram::available()</a>, and <a class="el" href="classRHDatagram.html#a76f519f91e9fd435e1c0be67ad999420">RHDatagram::recvfrom()</a>.</p>

<p>Referenced by <a class="el" href="classRHRouter.html#a4b662ef5e3a10e28698df9f99e47505b">RHRouter::recvfromAck()</a>, and <a class="el" href="classRHReliableDatagram.html#ac72c7495936b6f655a5765faac609342">recvfromAckTimeout()</a>.</p>

</div>
</div>
<a class="anchor" id="ac72c7495936b6f655a5765faac609342"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool RHReliableDatagram::recvfromAckTimeout </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>from</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>to</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>id</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>flags</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Similar to <a class="el" href="classRHReliableDatagram.html#af172410589842760babf938a0538334c">recvfromAck()</a>, this will block until either a valid message available for this node or the timeout expires. Starts the receiver automatically. You should be sure to call this function frequently enough to not miss any messages It is recommended that you call it in your main loop. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Location to copy the received message </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">len</td><td>Available space in buf. Set to the actual number of octets copied. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeout</td><td>Maximum time to wait in milliseconds </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">from</td><td>If present and not NULL, the referenced uint8_t will be set to the SRC address </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">to</td><td>If present and not NULL, the referenced uint8_t will be set to the DEST address </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>If present and not NULL, the referenced uint8_t will be set to the ID </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>If present and not NULL, the referenced uint8_t will be set to the FLAGS (not just those addressed to this node). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if a valid message was copied to buf </dd></dl>

<p>References <a class="el" href="classRHReliableDatagram.html#af172410589842760babf938a0538334c">recvfromAck()</a>.</p>

</div>
</div>
<a class="anchor" id="a01ac6fe8be733e1ccc0791d5ef44bb13"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RHReliableDatagram::resetRetransmissions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Resets the count of the number of retransmissions to 0. </p>

</div>
</div>
<a class="anchor" id="a4ed110f1a6a8cbc8de3cd17a1a4cce5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t RHReliableDatagram::retransmissions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the number of retransmissions we have had to send since starting or since the last call to <a class="el" href="classRHReliableDatagram.html#a01ac6fe8be733e1ccc0791d5ef44bb13">resetRetransmissions()</a>. </p><dl class="section return"><dt>Returns</dt><dd>The number of retransmissions since initialisation. </dd></dl>

</div>
</div>
<a class="anchor" id="ac6be14d9e660e1a4538376d4b4931d1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t RHReliableDatagram::retries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the currently configured maximum retries count. Can be changed with <a class="el" href="classRHReliableDatagram.html#a527306673a822c91d19e91327f2d4a80">setRetries()</a>. </p><dl class="section return"><dt>Returns</dt><dd>The currently configured maximum number of retries. </dd></dl>

<p>Referenced by <a class="el" href="classRHReliableDatagram.html#ad282ac147986a63692582f323b56c47f">sendtoWait()</a>, and <a class="el" href="classRHReliableDatagram.html#a527306673a822c91d19e91327f2d4a80">setRetries()</a>.</p>

</div>
</div>
<a class="anchor" id="ad282ac147986a63692582f323b56c47f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool RHReliableDatagram::sendtoWait </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send the message (with retries) and waits for an ack. Returns true if an acknowledgement is received. Synchronous: any message other than the desired ACK received while waiting is discarded. Blocks until an ACK is received or all retries are exhausted (ie up to retries*timeout milliseconds). If the destination address is the broadcast address RH_BROADCAST_ADDRESS (255), the message will be sent as a broadcast, but receiving nodes do not acknowledge, and <a class="el" href="classRHReliableDatagram.html#ad282ac147986a63692582f323b56c47f">sendtoWait()</a> returns true immediately without waiting for any acknowledgements. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">address</td><td>The address to send the message to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Pointer to the binary message to send </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Number of octets to send </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the message was transmitted and an acknowledgement was received. </dd></dl>

<p>References <a class="el" href="classRHDatagram.html#ae61ea3f68f3365d03249fd5807e989bd">RHDatagram::_thisAddress</a>, <a class="el" href="classRHReliableDatagram.html#ad1ea9f35e98d248bf595563e52f66183">acknowledge()</a>, <a class="el" href="classRHDatagram.html#a118f5c8f0ac925335cea6f23d2063467">RHDatagram::available()</a>, <a class="el" href="classRHDatagram.html#a76f519f91e9fd435e1c0be67ad999420">RHDatagram::recvfrom()</a>, <a class="el" href="classRHReliableDatagram.html#ac6be14d9e660e1a4538376d4b4931d1d">retries()</a>, <a class="el" href="classRHDatagram.html#a99894e3465aa607022cc240cc0394462">RHDatagram::sendto()</a>, <a class="el" href="classRHDatagram.html#a10dca3a92476b8ab7728bf39632a44cd">RHDatagram::setHeaderFlags()</a>, <a class="el" href="classRHDatagram.html#a4aac12bf5bcc900eb525fa1676113803">RHDatagram::setHeaderId()</a>, and <a class="el" href="classRHDatagram.html#a3b453d9b83c4da71acc62eea77af3d73">RHDatagram::waitPacketSent()</a>.</p>

<p>Referenced by <a class="el" href="classRHRouter.html#ab1a1865fe4de73356af8646a6cd9b8c8">RHRouter::route()</a>.</p>

</div>
</div>
<a class="anchor" id="a527306673a822c91d19e91327f2d4a80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RHReliableDatagram::setRetries </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>retries</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the maximum number of retries. Defaults to 3 at construction time. If set to 0, each message will only ever be sent once. sendtoWait will give up and return false if there is no ack received after all transmissions time out and the retries count is exhausted. param[in] retries The maximum number a retries. </p>

<p>References <a class="el" href="classRHReliableDatagram.html#ac6be14d9e660e1a4538376d4b4931d1d">retries()</a>.</p>

</div>
</div>
<a class="anchor" id="aa2ba123a53c34f0eb93bef0fe3f1cab0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RHReliableDatagram::setTimeout </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>timeout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the minimum retransmit timeout. If sendtoWait is waiting for an ack longer than this time (in milliseconds), it will retransmit the message. Defaults to 200ms. The timeout is measured from the end of transmission of the message. It must be at least longer than the the transmit time of the acknowledgement (preamble+6 octets) plus the latency/poll time of the receiver. For fast modulation schemes you can considerably shorten this time. The actual timeout is randomly varied between timeout and timeout*2. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">timeout</td><td>The new timeout period in milliseconds </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="RHReliableDatagram_8h_source.html">RHReliableDatagram.h</a></li>
<li>RHReliableDatagram.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
